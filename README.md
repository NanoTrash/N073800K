# N073800K
Этот скрипт выполняет двухэтапное сканирование сети с использованием инструмента `nmap`:

---

### **1. Первая часть: Сканирование всех портов**
```bash
ports=$(nmap -p- --min-rate=1000 -T4 10.10.10.3 | grep '^[0-9]' | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
```

#### Разбор команды:
1. **`nmap -p- --min-rate=1000 -T4 10.10.10.3`:**
   - `-p-`: Сканирует все возможные порты (от 1 до 65535).
   - `--min-rate=1000`: Устанавливает минимальную скорость отправки пакетов (1000 пакетов в секунду).
   - `-T4`: Указывает агрессивный режим сканирования (быстрее, но может быть более заметен для сетевых систем).
   - `10.10.10.3`: IP-адрес цели.

2. **`grep '^[0-9]'`:**
   - Выбирает строки, начинающиеся с цифр. Это фильтрует только те строки, которые содержат информацию о портах (например, `80/tcp open`).

3. **`cut -d '/' -f 1`:**
   - Разделяет строку по символу `/` и выбирает первую часть, то есть номер порта (например, из строки `80/tcp open` останется только `80`).

4. **`tr '\n' ','`:**
   - Заменяет символы новой строки (`\n`) на запятые, чтобы получить список портов в формате `80,443,22`.

5. **`sed s/,$//`:**
   - Удаляет последнюю запятую из строки, чтобы список портов выглядел корректно (например, `80,443,22` вместо `80,443,22,`).

6. **`ports=$(...)`:**
   - Результат выполнения всей команды сохраняется в переменную `ports`.

---

### **2. Вторая часть: Подробное сканирование найденных портов**
```bash
nmap -p$ports -sC -sV 10.10.10.3
```

#### Разбор команды:
1. **`-p$ports`:**
   - Указывает, что нужно сканировать только те порты, которые были найдены в первой части (хранятся в переменной `$ports`).

2. **`-sC`:**
   - Запускает стандартные скрипты Nmap для обнаружения дополнительной информации о службах, работающих на открытых портах.

3. **`-sV`:**
   - Пытается определить версии программного обеспечения, работающего на каждом открытом порту.

4. **`10.10.10.3`:**
   - IP-адрес цели.

---

### **Что делает весь скрипт?**
1. На первом этапе сканируются **все порты** целевого хоста (`10.10.10.3`), и находятся открытые порты.
2. На втором этапе выполняется более детальное сканирование **только открытых портов**, чтобы собрать дополнительную информацию о службах и их версиях.

---

### **Пример вывода**
Предположим, что первое сканирование нашло следующие открытые порты: `22,80,443`. Тогда команда будет эквивалентна:
```bash
nmap -p22,80,443 -sC -sV 10.10.10.3
```

Результат может выглядеть так:
```
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))
443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_ssl-date: TLS randomness does not represent time
```

---

### **Важные замечания**
1. **Права доступа:** Для выполнения таких сканирований могут потребоваться права суперпользователя (`sudo`), особенно если используется агрессивный режим (`-T4`).
2. **Этика использования:** Используйте этот скрипт только на тех системах, где у вас есть разрешение на проведение сканирования. Несанкционированное использование может быть незаконным.
3. **Зависимость от Nmap:** Убедитесь, что у вас установлен `nmap`, так как это основной инструмент для работы.

---
